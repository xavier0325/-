webpackJsonp([4],{"51QN":function(t,e){},"7n9t":function(t,e){},nQX9:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("t5DY"),n={props:["wsData"],data:function(){return{chartObj:null,yData:[],tranData:[]}},watch:{wsData:function(t){this.yData=t.tranmapData.map(function(t,e){return t.name}),this.tranData=t.tranmapData.map(function(t,e){return t.value}),this.chartObj.setOption({yAxis:{data:this.yData},series:[{type:"bar",data:this.tranData}]})}},mounted:function(){var t=s.a.getById(tsContainer),e=this.$echarts.init(t);this.chartObj=e,e.setOption(this.drawChart())},methods:{drawChart:function(){return{title:{text:"top10交通道路拥堵指数实时排序",left:"center",textStyle:{color:"#000"}},tooltip:{},grid:{show:!0,bottom:"6%"},xAxis:{max:"dataMax",axisLabel:{color:"#000"},axisTick:{show:!0}},yAxis:{type:"category",data:this.yData,inverse:!0,axisLabel:{color:"#000"},animationDuration:300,animationDurationUpdate:300,max:9},legend:{show:!0,top:"6%"},series:[{realtimeSort:!0,name:"交通道路拥堵指数",type:"bar",data:this.tranData,label:{show:!0,position:"right",valueAnimation:!0},itemStyle:{borderRadius:[0,10,10,0]}}],animationDuration:0,animationDurationUpdate:1e3,animationEasing:"linear",animationEasingUpdate:"linear"}}}},o={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{attrs:{id:"tsContainer"}})},staticRenderFns:[]};var i={components:{tranSort:a("VU/8")(n,o,!1,function(t){a("51QN")},"data-v-49f77254",null).exports},data:function(){return{startPoint:{x:112.870634,y:27.887929},zoom:15,searchList:[],searchWord:"",path:"ws://localhost:8888/tranmap/tranmap_ws",socket:"",wsData:{}}},mounted:function(){var t,e=this,a=new BMap.Map("tranmap");this.wsInit(),a.centerAndZoom(new BMap.Point(this.startPoint.x,this.startPoint.y),this.zoom),a.setCurrentCity("湘潭"),a.enableScrollWheelZoom(!0);var n=new BMapLib.TrafficControl({showPanel:!0}),o=new BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_RIGHT,type:BMAP_NAVIGATION_CONTROL_SMALL,offset:new BMap.Size(10,50)}),i=new BMap.ScaleControl({anchor:BMAP_ANCHOR_TOP_LEFT,offset:new BMap.Size(100,5)}),r=new BMap.MapTypeControl({anchor:BMAP_ANCHOR_TOP_RIGHT,mapTypes:[BMAP_NORMAL_MAP,BMAP_HYBRID_MAP]}),c=new BMap.OverviewMapControl({anchor:BMAP_ANCHOR_TOP_RIGHT,offset:new BMap.Size(10,500),isOpen:!0});a.addControl(n),a.addControl(o),a.addControl(i),a.addControl(r),a.addControl(c),n.setAnchor(BMAP_ANCHOR_TOP_LEFT),n.showTraffic();new BMap.Autocomplete({input:"searchInput",location:a,onSearchComplete:function(t){var a=t.Cr,s=[];e.searchList.splice(0,e.searchList.length);for(var n=0;n<a.length;n++)s.push(a[n]);e.searchList=[].concat(s)}});function h(){a.clearOverlays();var s=new BMap.LocalSearch(a,{onSearchComplete:function(){var t=s.getResults().getPoi(0).point;a.centerAndZoom(t,e.zoom),a.addOverlay(new BMap.Marker(t))}});s.search(t)}s.a.getById(searchInput).onkeydown=function(s){13===s.keyCode&&s.target.baseURI.match(/tranmap$/i)&&(""===e.searchWord.trim()?(e.searchList.splice(0,e.searchList.length),a.centerAndZoom(new BMap.Point(e.startPoint.x,e.startPoint.y),e.zoom)):(e.searchList.splice(0,e.searchList.length),t=e.searchWord,h()))},s.a.getById(searchBtn).addEventListener("click",function(){""===e.searchWord.trim()?(e.searchList.splice(0,e.searchList.length),a.centerAndZoom(new BMap.Point(e.startPoint.x,e.startPoint.y),e.zoom)):(e.searchList.splice(0,e.searchList.length),t=e.searchWord,h())}),s.a.getById(tipBox).addEventListener("click",function(a){t=a.target.innerText,h(),e.searchList.splice(0,e.searchList.length)})},destroyed:function(){this.socket.onclose=this.wsClose},methods:{checkValue:function(t){""==this.searchWord&&this.searchList.splice(0,this.searchList.length)},wsInit:function(){WebSocket?(this.socket=new WebSocket(this.path),this.socket.onopen=this.wsOpen,this.socket.onerror=this.wsError,this.socket.onmessage=this.wsGetMsg):console.log("Your browser do not apply WebSocket!")},wsOpen:function(){console.log("WebSocket连接成功!"),this.socket.send("tranmap客户端已连接WebSocket服务!")},wsError:function(){console.log("WebSocket连接错误!正在重连..."),this.wsInit()},wsGetMsg:function(t){this.wsData=JSON.parse(t.data)},wsSend:function(t){this.socket.send(t)},wsClose:function(){this.socket.close(),this.socket=void 0,console.log("WebSocket连接关闭!"),this.socket.send("连接断开")}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{attrs:{id:"tranmap"}}),t._v(" "),a("div",{attrs:{id:"tranSortBox"}},[a("tranSort",{attrs:{wsData:t.wsData}})],1),t._v(" "),a("div",{attrs:{id:"searchBox"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchWord,expression:"searchWord"}],attrs:{type:"search",id:"searchInput",size:"20",placeholder:"请输入检索地点"},domProps:{value:t.searchWord},on:{input:[function(e){e.target.composing||(t.searchWord=e.target.value)},t.checkValue]}}),t._v(" "),a("label",{attrs:{id:"searchBtn"}},[a("svg",{staticClass:"icon",attrs:{t:"1648187269632",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5334",width:"18",height:"18"}},[a("path",{attrs:{d:"M1004.8 915.2l-243.2-243.2c0 0-6.4-6.4-6.4-6.4C800 595.2 832 505.6 832 416 832 185.6 646.4 0 416 0S0 185.6 0 416 185.6 832 416 832c89.6 0 179.2-32 243.2-83.2 0 6.4 6.4 6.4 6.4 6.4l243.2 243.2c25.6 25.6 70.4 25.6 96 6.4C1030.4 979.2 1030.4 940.8 1004.8 915.2zM64 416C64 224 224 64 416 64S768 224 768 416 608 768 416 768 64 608 64 416z","p-id":"5335",fill:"#aaaaaa"}})])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.searchList.length,expression:"searchList.length"}],attrs:{id:"tipBox"}},t._l(t.searchList,function(e,s){return a("span",{key:s,staticClass:"searchItem"},[a("svg",{staticClass:"icon",attrs:{t:"1648187269632",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5334",width:"14",height:"14"}},[a("path",{attrs:{d:"M1004.8 915.2l-243.2-243.2c0 0-6.4-6.4-6.4-6.4C800 595.2 832 505.6 832 416 832 185.6 646.4 0 416 0S0 185.6 0 416 185.6 832 416 832c89.6 0 179.2-32 243.2-83.2 0 6.4 6.4 6.4 6.4 6.4l243.2 243.2c25.6 25.6 70.4 25.6 96 6.4C1030.4 979.2 1030.4 940.8 1004.8 915.2zM64 416C64 224 224 64 416 64S768 224 768 416 608 768 416 768 64 608 64 416z","p-id":"5335",fill:"#aaaaaa"}})]),t._v(" "),a("b",{staticStyle:{"font-weight":"bolder"}},[t._v(t._s(e.province)+t._s(e.city))]),t._v(t._s(e.district)+t._s(e.street)+t._s(e.business)+"\n      ")])}),0)])])},staticRenderFns:[]};var c=a("VU/8")(i,r,!1,function(t){a("7n9t")},"data-v-9490efc4",null);e.default=c.exports}});
//# sourceMappingURL=4.1088f651006534e38d99.js.map